//
//  APIConfiguration.swift.example
//  KinoPubTV
//
//  INSTRUCTIONS FOR XCCONFIG APPROACH (RECOMMENDED):
//  1. Copy Config/Secrets.xcconfig.example to Config/Secrets.xcconfig
//  2. Fill in your API keys in Secrets.xcconfig
//  3. In Xcode: Project ‚Üí Info ‚Üí Configurations ‚Üí Set both Debug and Release to use Secrets.xcconfig
//  4. Build the project - keys will be injected at build time
//
//  ALTERNATIVE (Manual file copy):
//  1. Copy this file to APIConfiguration.swift (remove .example)
//  2. The current implementation reads from Info.plist first, then environment
//  3. Never commit APIConfiguration.swift or Secrets.xcconfig to version control
//

import Foundation

enum APIConfiguration {
    // MARK: - KinoPub API
    
    /// KinoPub OAuth Client ID
    static let kinoPubClientID = "xbmc"
    
    /// KinoPub OAuth Client Secret
    /// Loaded from Info.plist ‚Üí Environment ‚Üí Empty
    static let kinoPubClientSecret: String = {
        // First try Info.plist (set by xcconfig at build time)
        if let secret = Bundle.main.object(forInfoDictionaryKey: "KINOPUB_CLIENT_SECRET") as? String,
           !secret.isEmpty, !secret.contains("$(") {
            return secret
        }
        // Fallback to environment variable (for CI/testing)
        if let envSecret = ProcessInfo.processInfo.environment["KINOPUB_CLIENT_SECRET"],
           !envSecret.isEmpty {
            return envSecret
        }
        return ""
    }()
    
    // MARK: - TMDB API
    
    /// The Movie Database (TMDB) API Key
    /// Loaded from Info.plist ‚Üí Environment ‚Üí Empty
    static let tmdbAPIKey: String = {
        // First try Info.plist (set by xcconfig at build time)
        if let key = Bundle.main.object(forInfoDictionaryKey: "TMDB_API_KEY") as? String,
           !key.isEmpty, !key.contains("$(") {
            return key
        }
        // Fallback to environment variable (for CI/testing)
        if let envKey = ProcessInfo.processInfo.environment["TMDB_API_KEY"],
           !envKey.isEmpty {
            return envKey
        }
        return ""
    }()
    
    // MARK: - Helper Methods
    
    /// Check if all required API keys are configured
    static var isConfigured: Bool {
        return !kinoPubClientSecret.isEmpty && !tmdbAPIKey.isEmpty
    }
    
    /// Print configuration status (for debugging)
    static func printStatus() {
        #if DEBUG
        print("üîê API Configuration Status:")
        print("  - KinoPub Client ID: \(kinoPubClientID)")
        print("  - KinoPub Client Secret: \(kinoPubClientSecret.isEmpty ? "‚ùå Not set" : "‚úÖ Configured")")
        print("  - TMDB API Key: \(tmdbAPIKey.isEmpty ? "‚ùå Not set" : "‚úÖ Configured")")
        #endif
    }
}
